(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48],{1379:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenants/create",function(){return r(771)}])},4153:function(e,t,r){"use strict";var n=r(5893),i=r(2963),s=r(5861),a=r(3795);t.Z=function(e){var t=e.crumbs,r=void 0===t?[]:t;return(0,n.jsx)(i.Z,{"aria-label":"breadcrumb",children:r.map((function(e,t){var r=e.title,i=e.onClick;return i?(0,n.jsx)(a.Z,{id:"crumb_".concat(t),underline:"hover",className:"pointer",color:"inherit",onClick:i,children:r}):(0,n.jsx)(s.Z,{id:"crumb_".concat(t),color:"text.primary",children:r})}))})}},771:function(e,t,r){"use strict";r.r(t);var n=r(4051),i=r.n(n),s=r(5893),a=r(7294),o=r(4153),l=r(5861),c=r(1812),d=r(3321),u=r(3795),h=r(7357),x=r(135),m=r(6886),p=r(3841),f=r(8360),j=r(8972),v=r(4054),Z=r(6815),y=r(6901),g=r(9368),b=r(3457),P=r(480),D=r(7720),S=r(5916),w=r(2359),I=r(7463),k=r(7906),N=r(295),F=r(3252),T=r(2882),q=r(3184),M=r(3816),_=r(5113),C=r(6624),A=r(4472),E=r(3578),O=r(919),R=r(1163),L=r(7536),B=r(9669),z=r.n(B),W=r(381),$=r.n(W),Y=r(8100),G=r(1178);function V(e,t,r,n,i,s,a){try{var o=e[s](a),l=o.value}catch(c){return void r(c)}o.done?t(l):Promise.resolve(l).then(n,i)}function K(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function a(e){V(s,n,i,a,o,"next",e)}function o(e){V(s,n,i,a,o,"throw",e)}a(void 0)}))}}function X(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){X(e,t,r[t])}))}return e}var U=function(){var e,t,r=(0,Y.D3)().user,n=(0,R.useRouter)(),O=(0,a.useState)(),B=O[0],W=O[1],V=(0,a.useState)(),X=V[0],U=V[1],H=(0,a.useState)(!1),J=H[0],ee=H[1],te=(0,a.useState)(null),re=te[0],ne=te[1],ie=(0,a.useState)(null),se=ie[0],ae=ie[1],oe=(0,a.useState)(0),le=oe[0],ce=oe[1],de=["Tenant information","Invoice details","Review"],ue=(0,L.cI)({defaultValues:{propertyId:"",createMonthlySubscription:!1,addProratedFirstMonthsRent:!1,addLastMonthsRentToInvoice:!1,addSecurityDepositToInvoice:!1}}),he=ue.register,xe=ue.handleSubmit,me=ue.getValues,pe=ue.setValue,fe=ue.clearErrors,je=ue.trigger,ve=ue.watch,Ze=ue.control,ye=ue.formState.errors;he("moveInDate",{required:"Move in date is required",valueAsDate:!0}),he("billingStartDate",{required:"Billing start date is required",valueAsDate:!0});var ge=ve("securityDeposit"),be=ve("createMonthlySubscription"),Pe=ve("addProratedFirstMonthsRent"),De=ve("addLastMonthsRentToInvoice"),Se=ve("addSecurityDepositToInvoice"),we=function(){var e=K(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ee(!0),e.next=3,z().post("/api/tenants",t).catch((function(){ee(!1)}));case 3:n.push(G.Ke);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ie=function(e){var t;return null===(t=ye[e])||void 0===t?void 0:t.message},ke=function(e){return void 0!==ye[e]};(0,a.useEffect)((function(){var e=function(){var e=K(i().mark((function e(){var t,n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z().get("/api/properties/search/findByCreatedBy",{params:{email:r.email}});case 2:t=e.sent,n=t.data,s=n._embedded.properties,W(s);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[r]),(0,a.useEffect)((function(){var e=function(){var e=K(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z().get("/api/landlord-user/profile",{params:{returnPath:"/tenants/create"}}).then((function(e){var t=e.data;U(t)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var Ne=(0,a.useMemo)((function(){if(!B)return[];var e=me("propertyId");if(""===e)return[];var t=B.find((function(t){return t.id===e})),r=t.address,n=t.rent,i=[],s=0;if(Se){i.push({name:"".concat(r," - Security deposit"),calories:parseFloat(ge).toFixed(2)});var a=parseFloat(ge);isNaN(a)||(s+=a)}if(Pe){var o=$()(re),l=12*n/365*$()(se).diff(o,"days");i.push({name:"".concat(r," - Prorated first months rent"),calories:l.toFixed(2)}),s+=l}return De&&(i.push({name:"".concat(r," - Last months rent"),calories:parseFloat(n).toFixed(2)}),s+=n),{items:i,total:s=(Math.round(100*(s+Number.EPSILON))/100).toFixed(2)}}),[Pe,De,Se,ge,se,me,re,B]);if(!X||!B)return(0,s.jsx)(s.Fragment,{});var Fe=function(){var e=K(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==le){e.next=6;break}return e.next=3,je(["propertyId","fullName","email","moveInDate","billingStartDate","securityDeposit"]);case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:ce((function(e){return e+1}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{crumbs:[{title:"Tenants",onClick:function(){return n.push(G.Ke)}},{title:"Create"}]}),(0,s.jsx)(h.Z,{m:2,children:(0,s.jsxs)("form",{onSubmit:xe(we),children:[(0,s.jsx)(C.Z,{activeStep:le,children:de.map((function(e){return(0,s.jsx)(A.Z,Q({},{},{children:(0,s.jsx)(E.Z,Q({},{},{children:e}))}),e)}))}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Z,{sx:{mt:2,mb:1},children:["Step ",le+1]}),0===le&&(0,s.jsxs)(m.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(m.ZP,{item:!0,xs:12,sm:4,children:(0,s.jsxs)(v.Z,{fullWidth:!0,required:!0,margin:"normal",size:"small",error:ke("propertyId"),children:[(0,s.jsx)(p.Z,{htmlFor:"property-select",children:"Property"}),(0,s.jsx)(L.Qr,{control:Ze,name:"propertyId",render:function(){return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(f.Z,Q({},he("propertyId",{required:"Property is a required field."}),{id:"property-select",label:"Property",disabled:0===B.length,value:me("propertyId"),children:B.map((function(e){return(0,s.jsx)(j.Z,{value:e.id,children:e.address},e.id)}))}))})}}),(0,s.jsx)(Z.Z,{error:!0,children:Ie("propertyId")})]})}),(0,s.jsx)(m.ZP,{item:!0,xs:12,sm:4,children:(0,s.jsx)(x.Z,Q({},he("fullName",{required:"Full name is a required field."}),{fullWidth:!0,required:!0,margin:"normal",size:"small",label:"Full Name",helperText:Ie("fullName"),error:ke("fullName")}))}),(0,s.jsx)(m.ZP,{item:!0,xs:12,sm:4,children:(0,s.jsx)(x.Z,Q({},he("email",{required:"Email is a required field."}),{fullWidth:!0,required:!0,margin:"normal",size:"small",label:"Email",helperText:Ie("email"),error:ke("email")}))}),(0,s.jsx)(m.ZP,{item:!0,xs:12,sm:4,children:(0,s.jsx)(w._,{dateAdapter:S.Z,children:(0,s.jsx)(I.$,{label:"Move in date",value:re,minDate:$()().add(1,"days"),renderInput:function(e){return(0,s.jsx)(x.Z,Q({fullWidth:!0,required:!0,margin:"normal",size:"small"},e,{helperText:Ie("moveInDate"),error:ke("moveInDate")}))},onChange:function(e){e&&(ne(e.toDate()),pe("moveInDate",e.toDate()))}})})}),(0,s.jsx)(m.ZP,{item:!0,xs:12,sm:4,children:(0,s.jsx)(w._,{dateAdapter:S.Z,children:(0,s.jsx)(I.$,{label:"Billing start date",value:se,minDate:$()().add(1,"days"),renderInput:function(e){return(0,s.jsx)(x.Z,Q({fullWidth:!0,required:!0,margin:"normal",size:"small"},e,{helperText:Ie("billingStartDate"),error:ke("billingStartDate")}))},onChange:function(e){e&&(ae(e.toDate()),pe("billingStartDate",e.toDate()))}})})}),(0,s.jsx)(m.ZP,{item:!0,xs:12,sm:4,children:(0,s.jsx)(x.Z,Q({},he("securityDeposit",{required:"Security deposit is a required field",validate:function(e){return!(""===e||e<=0)}}),{inputProps:{inputMode:"numeric",pattern:"[0-9]*",step:"0.01"},fullWidth:!0,required:!0,type:"number",margin:"normal",size:"small",label:"Security Deposit ($)",helperText:Ie("securityDeposit"),error:ke("securityDeposit")}))})]}),1===le&&(0,s.jsx)(m.ZP,{container:!0,spacing:2,children:(0,s.jsx)(m.ZP,{item:!0,sm:6,children:(0,s.jsxs)(b.Z,{children:[(0,s.jsx)(P.Z,{control:(0,s.jsx)(g.Z,Q({checked:be},he("createMonthlySubscription"))),label:"Generate monthly invoices to collect rent"}),(0,s.jsx)(P.Z,{control:(0,s.jsx)(g.Z,Q({checked:Pe},he("addProratedFirstMonthsRent"))),label:"Add first months prorated rent to initial invoice"}),(0,s.jsx)(P.Z,{control:(0,s.jsx)(g.Z,Q({checked:De},he("addLastMonthsRentToInvoice"))),label:"Add last months rent to initial invoice"}),(0,s.jsx)(P.Z,{control:(0,s.jsx)(g.Z,Q({checked:Se},he("addSecurityDepositToInvoice",{onChange:function(e){e.target.checked||fe("securityDeposit")}}))),label:"Add security deposit to initial invoice"})]})})}),2===le&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(h.Z,{justifyContent:"center",width:650,margin:"0 auto",padding:2,children:[(0,s.jsx)(l.Z,{variant:"h6",children:"Tenant information"}),(0,s.jsxs)(m.ZP,{container:!0,spacing:1,padding:1,marginBottom:1,children:[(0,s.jsx)(m.ZP,{item:!0,xs:8,children:(0,s.jsx)(l.Z,{variant:"subtitle2",children:"Full name:"})}),(0,s.jsx)(m.ZP,{item:!0,xs:4,children:me("fullName")}),(0,s.jsx)(m.ZP,{item:!0,xs:8,children:(0,s.jsx)(l.Z,{variant:"subtitle2",children:"Email:"})}),(0,s.jsx)(m.ZP,{item:!0,xs:4,children:me("email")}),(0,s.jsx)(m.ZP,{item:!0,xs:8,children:(0,s.jsx)(l.Z,{variant:"subtitle2",children:"Move in date:"})}),(0,s.jsx)(m.ZP,{item:!0,xs:4,children:re.toLocaleDateString()}),(0,s.jsx)(m.ZP,{item:!0,xs:8,children:(0,s.jsx)(l.Z,{variant:"subtitle2",children:"Billing start date:"})}),(0,s.jsx)(m.ZP,{item:!0,xs:4,children:se.toLocaleDateString()})]}),(0,s.jsx)(D.Z,{}),(0,s.jsx)(l.Z,{variant:"h6",marginTop:1,children:"Invoice details"}),(0,s.jsxs)(m.ZP,{container:!0,spacing:1,padding:1,marginBottom:1,children:[(0,s.jsx)(m.ZP,{item:!0,xs:8,children:(0,s.jsx)(l.Z,{variant:"subtitle2",children:"Generate monthly invoices to collect rent?"})}),(0,s.jsx)(m.ZP,{item:!0,xs:4,children:me("createMonthlySubscription")?"Yes":"No"}),(0,s.jsx)(m.ZP,{item:!0,xs:8,children:(0,s.jsx)(l.Z,{variant:"subtitle2",children:"Add first months prorated rent to initial invoice?"})}),(0,s.jsx)(m.ZP,{item:!0,xs:4,children:me("addProratedFirstMonthsRent")?"Yes":"No"}),(0,s.jsx)(m.ZP,{item:!0,xs:8,children:(0,s.jsx)(l.Z,{variant:"subtitle2",children:"Add last months rent to initial invoice?"})}),(0,s.jsx)(m.ZP,{item:!0,xs:4,children:me("addLastMonthsRentToInvoice")?"Yes":"No"}),(0,s.jsx)(m.ZP,{item:!0,xs:8,children:(0,s.jsx)(l.Z,{variant:"subtitle2",children:"Add security deposit to initial invoice?"})}),(0,s.jsx)(m.ZP,{item:!0,xs:4,children:me("addSecurityDepositToInvoice")?"Yes":"No"})]}),(0,s.jsx)(D.Z,{}),(0,s.jsx)(l.Z,{variant:"h6",marginTop:1,children:"Deposit"}),(De||Se)&&(0,s.jsxs)(h.Z,{margin:2,children:[(0,s.jsx)(T.Z,{component:_.Z,children:(0,s.jsxs)(k.Z,{size:"small",children:[(0,s.jsx)(q.Z,{children:(0,s.jsxs)(M.Z,{children:[(0,s.jsx)(F.Z,{children:"Items"}),(0,s.jsx)(F.Z,{align:"right",children:"Amount ($)"})]})}),(0,s.jsx)(N.Z,{children:Ne.items.map((function(e){return(0,s.jsxs)(M.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,s.jsx)(F.Z,{component:"th",scope:"row",children:e.name}),(0,s.jsx)(F.Z,{align:"right",children:e.calories})]},e.name)}))})]})}),(0,s.jsx)(h.Z,{sx:{display:"flex",justifyContent:"flex-end",padding:"8px"},children:(0,s.jsxs)(l.Z,{variant:"h6",children:["Total: $",Ne.total]})})]})]})}),(0,s.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",pt:2},children:[(0,s.jsx)(d.Z,{color:"inherit",disabled:0===le,onClick:function(){ce((function(e){return e-1}))},sx:{mr:1},children:"Back"}),(0,s.jsx)(h.Z,{sx:{flex:"1 1 auto"}}),le<de.length-1&&(0,s.jsx)(d.Z,{onClick:Fe,children:"Next"}),le===de.length-1&&(0,s.jsx)(c.Z,{variant:"contained",type:"submit",loading:J,children:"Finish"})]})]})]})}),!1===(null===X||void 0===X||null===(e=X.paymentAccountStatus)||void 0===e?void 0:e.isOnboarded)&&(0,s.jsxs)(y.Z,{severity:"warning",children:["Click ",(0,s.jsx)(u.Z,{className:"pointer",href:null===(t=X.paymentAccountStatus)||void 0===t?void 0:t.onboardingUrl,children:"here"})," to configure your payout method with Stripe before inviting tenants."]}),0===B.length&&(0,s.jsxs)(y.Z,{severity:"warning",children:["Click ",(0,s.jsx)(u.Z,{className:"pointer",href:"/properties/create",children:"here"})," to add a property before inviting tenants."]})]})};U.getLayout=O.G,t.default=U}},function(e){e.O(0,[885,602,587,658,198,673,644,182,589,917,774,888,179],(function(){return t=1379,e(e.s=t);var t}));var t=e.O();_N_E=t}]);